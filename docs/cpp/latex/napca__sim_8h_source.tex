\doxysection{napca\+\_\+sim.\+h}
\hypertarget{napca__sim_8h_source}{}\label{napca__sim_8h_source}\index{cpp/include/napca\_sim.h@{cpp/include/napca\_sim.h}}
\mbox{\hyperlink{napca__sim_8h}{Aller Ã  la documentation de ce fichier.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ NAPCA\_SIM\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ NAPCA\_SIM\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{module_8h}{module.h}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tensor_8h}{tensor.h}}"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <unordered\_map>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classNAPCA__Sim}{NAPCA\_Sim}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classModule}{Module}}\ \{}
\DoxyCodeLine{00011\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{classNAPCA__Sim_a520c224931991934de9484b714cb1a40}{NAPCA\_Sim}}(\textcolor{keywordtype}{int}\ in\_features,\ \textcolor{keywordtype}{int}\ out\_features,\ \textcolor{keywordtype}{float}\ alpha\ =\ 0.6f,\ \textcolor{keywordtype}{float}\ threshold\ =\ 0.5f);}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a27fa0d061da6e123cd8ed81d27a552a0}{forward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ input,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ output)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a1ff8ba3edf87ab2ae0bea337299144d8}{backward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_output,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_input)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a5f1d9e061d7c4077a9923d1700231860}{update}}(\textcolor{keywordtype}{float}\ lr)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00031\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classNAPCA__Sim_a8224ac0aa6edc73caf3b524c449da724}{get\_weights}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00034\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classNAPCA__Sim_ab837d117edec8b0ebb792aea78f5e91d}{get\_grad\_weights}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a95aa0cd3535da7bf4f16bf94b3db6158}{set\_weights}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ weights)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordtype}{float}\ \mbox{\hyperlink{classNAPCA__Sim_a5293c69ada22a7ade0bd79db2ebf4d25}{compute\_path\_similarity}}(\textcolor{keyword}{const}\ std::vector<int>\&\ path1,\ \textcolor{keyword}{const}\ std::vector<int>\&\ path2);}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a0a1d0d902446bb0a8310cd57db313452}{update\_weights\_conditionally}}(\textcolor{keyword}{const}\ std::vector<std::pair<int,int>>\&\ similar\_pairs,\ \textcolor{keywordtype}{float}\ eta);}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a72f8a306c0f06f205715c793b0cc681e}{prune\_connections}}(\textcolor{keywordtype}{float}\ threshold\ =\ 0.01f);}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_a42fe723a615b508f27bf25b198c5ec34}{save}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classNAPCA__Sim_af490c677a9cc4c35fe13b78aaa1828a3}{load}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ weights\_;}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ bias\_;}
\DoxyCodeLine{00060\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ grad\_weights\_;}
\DoxyCodeLine{00061\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ grad\_bias\_;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{float}\ learning\_rate\_;}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{float}\ alpha\_;}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{float}\ threshold\_;}
\DoxyCodeLine{00065\ \ \ \ \ std::vector<std::vector<int>>\ memory\_paths\_;}
\DoxyCodeLine{00066\ \ \ \ \ std::unordered\_map<int,\ bool>\ active\_connections\_;}
\DoxyCodeLine{00067\ \textcolor{preprocessor}{\#ifdef\ USE\_CUDA}}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keywordtype}{void}\ forward\_cuda(\mbox{\hyperlink{classTensor}{Tensor}}\&\ input,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ output);}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{void}\ backward\_cuda(\mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_output,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_input);}
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ NAPCA\_SIM\_H}}

\end{DoxyCode}
