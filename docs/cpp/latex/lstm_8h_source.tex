\doxysection{lstm.\+h}
\hypertarget{lstm_8h_source}{}\label{lstm_8h_source}\index{cpp/include/lstm.h@{cpp/include/lstm.h}}
\mbox{\hyperlink{lstm_8h}{Aller à la documentation de ce fichier.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ File:\ cpp/include/lstm.h}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifndef\ LSTM\_H}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ LSTM\_H}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{module_8h}{module.h}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tensor_8h}{tensor.h}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{linear_8h}{linear.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{activation_8h}{activation.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classLSTM}{LSTM}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classModule}{Module}}\ \{}
\DoxyCodeLine{00015\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00016\ \ \ \ \ \mbox{\hyperlink{classLSTM_a9d9d454e66575f18f247f94acd9d776a}{LSTM}}(\textcolor{keywordtype}{int}\ input\_size,\ \textcolor{keywordtype}{int}\ hidden\_size,\ \textcolor{keywordtype}{int}\ num\_layers);}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_a17688a1c3dae0ec5941fcd8b8a2237fb}{forward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ input,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ output)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_a013d70ce1677930c0bd51c9cf4039f6a}{backward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_output,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_input)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_a2952e865ad5b27d97ec0120713b1c161}{update}}(\textcolor{keywordtype}{float}\ lr)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classLSTM_af63e3d4079f9abdb2e2ecc48b1458be0}{get\_weights}}()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ weights\_;\ \}}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classLSTM_a2bd73c283e6c3cd58194a7849ac65fa3}{get\_grad\_weights}}()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ grad\_weights\_;\ \}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_a106c5ba3d204a7a0178c8b577d0f4538}{set\_weights}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ w)\textcolor{keyword}{\ override\ }\{\ weights\_\ =\ w;\ \}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_aa20c7a5acc787ad723d78e75dd882ff3}{save}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classLSTM_a14a082e508fc2efe09a9b1ce258156c5}{load}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{int}\ input\_size\_,\ hidden\_size\_,\ num\_layers\_;}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ Pour\ chaque\ couche\ l\ :}}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{comment}{//\ \ \ Linear(input→4*hidden)\ +\ Linear(hidden→4*hidden)}}
\DoxyCodeLine{00041\ \ \ \ \ std::vector<std::shared\_ptr<Linear>>\ input\_to\_hidden\_,\ hidden\_to\_hidden\_;}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{//\ activations\ pour\ i,f,o\ et\ g}}
\DoxyCodeLine{00043\ \ \ \ \ std::vector<std::shared\_ptr<Sigmoid>>\ gate\_act\_;}
\DoxyCodeLine{00044\ \ \ \ \ std::vector<std::shared\_ptr<Tanh>>\ \ \ \ g\_act\_;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ weights\_,\ grad\_weights\_;\ \textcolor{comment}{//\ placeholders}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{//\ Caches\ [timestep][layer]}}
\DoxyCodeLine{00049\ \ \ \ \ std::vector<std::vector<Tensor>>\ x\_cache\_,\ h\_prev\_cache\_,\ c\_prev\_cache\_;}
\DoxyCodeLine{00050\ \ \ \ \ std::vector<std::vector<Tensor>>\ i\_cache\_,\ f\_cache\_,\ g\_cache\_,\ o\_cache\_;}
\DoxyCodeLine{00051\ \ \ \ \ std::vector<std::vector<Tensor>>\ c\_cache\_,\ h\_cache\_;}
\DoxyCodeLine{00052\ \};}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ LSTM\_H}}
\DoxyCodeLine{00055\ }

\end{DoxyCode}
