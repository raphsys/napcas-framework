\doxysection{gru.\+h}
\hypertarget{gru_8h_source}{}\label{gru_8h_source}\index{cpp/include/gru.h@{cpp/include/gru.h}}
\mbox{\hyperlink{gru_8h}{Aller Ã  la documentation de ce fichier.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ File:\ cpp/include/gru.h}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#ifndef\ GRU\_H}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#define\ GRU\_H}}
\DoxyCodeLine{00005\ }
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{module_8h}{module.h}}"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{tensor_8h}{tensor.h}}"{}}}
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{linear_8h}{linear.h}}"{}}}
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{activation_8h}{activation.h}}"{}}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <memory>}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classGRU}{GRU}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classModule}{Module}}\ \{}
\DoxyCodeLine{00015\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00016\ \ \ \ \ \mbox{\hyperlink{classGRU_ab503a83a301ad2a8d2a43a308819c0e8}{GRU}}(\textcolor{keywordtype}{int}\ input\_size,\ \textcolor{keywordtype}{int}\ hidden\_size,\ \textcolor{keywordtype}{int}\ num\_layers);}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_ac5d5f5710e5285e904435ccf28c43bcf}{forward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ input,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ output)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_a8f6280f11215c2c36db1674fee7e81de}{backward}}(\mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_output,\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ grad\_input)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_a4f6cb295fe3d21e72c55621025b43afc}{update}}(\textcolor{keywordtype}{float}\ lr)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classGRU_a471810a13f19eff58fb48abd72f0d853}{get\_weights}}()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ weights\_;\ \}}
\DoxyCodeLine{00030\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\&\ \mbox{\hyperlink{classGRU_a053b6a41a36717c6d38cd9db02c636a2}{get\_grad\_weights}}()\textcolor{keyword}{\ override\ }\{\ \textcolor{keywordflow}{return}\ grad\_weights\_;\ \}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_af9b9aab2f614bfc4294dc3b10420104a}{set\_weights}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{classTensor}{Tensor}}\&\ weights)\textcolor{keyword}{\ override\ }\{\ weights\_\ =\ weights;\ \}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_abe6800e384125bd61c9429afd31bdefb}{save}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classGRU_a49382d8540f471ab519b453b772ec621}{load}}(\textcolor{keyword}{const}\ std::string\&\ path)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00035\ }
\DoxyCodeLine{00036\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{int}\ input\_size\_;}
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{keywordtype}{int}\ hidden\_size\_;}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{int}\ num\_layers\_;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ std::vector<std::shared\_ptr<Linear>>\ \ input\_to\_hidden\_;}
\DoxyCodeLine{00042\ \ \ \ \ std::vector<std::shared\_ptr<Linear>>\ \ hidden\_to\_hidden\_;}
\DoxyCodeLine{00043\ \ \ \ \ std::vector<std::shared\_ptr<Sigmoid>>\ gate\_activations\_;}
\DoxyCodeLine{00044\ \ \ \ \ std::vector<std::shared\_ptr<Tanh>>\ \ \ \ tanh\_activations\_;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{classTensor}{Tensor}}\ weights\_,\ grad\_weights\_;}
\DoxyCodeLine{00047\ \ \ \ \ std::vector<Tensor>\ hidden\_states\_;\ \ \textcolor{comment}{//\ h\_t\ pour\ chaque\ couche}}
\DoxyCodeLine{00048\ \};}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ GRU\_H}}
\DoxyCodeLine{00051\ }

\end{DoxyCode}
